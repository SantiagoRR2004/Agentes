@startuml
start

:Llamada a goToRoom(Target) o moveTowardsAdvanced(Objective);

if (¿Está en la misma habitación que el objetivo?) then (sí)
  :move_towards(Objective);
else (no)
  :Calcular camino más corto usando shortestRoomPath;
  :Obtener primera puerta del camino;
  
  if (¿Está en una puerta?) then (sí)
    :Marcar wasAtDoor = true;
  else (no)
    :Marcar wasAtDoor = false;
  endif
  
  :Mover hacia primera puerta;
  
  if (¿Está en puerta Y wasAtDoor?) then (sí)
    :Atasco detectado;
    repeat
      :Movimiento aleatorio (unstuckFromDoor);
    repeat while (¿Sigue en puerta?) is (sí)
    ->no;
  endif
endif

:Decrementar paciencia;

stop
@enduml